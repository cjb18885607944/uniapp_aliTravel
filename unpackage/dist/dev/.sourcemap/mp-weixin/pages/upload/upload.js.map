{"version":3,"sources":["webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/main.js","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?39ed","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?26cf","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?74df","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?9b24","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?c979","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?1e4b"],"names":["createPage","Page","util","require","time","formatTime","Date","name","data","currentIndex","classify","book","classifyName","uploadTitle","uploadContent","uploadedImg","videoSrc","address","avatar","nickName","openid","computed","getCity","city","methods","tapItem","index","uploadImg","uni","chooseImage","count","sizeType","sourceType","success","res","console","log","push","tempFilePaths","delImage","splice","previewImg","then","catch","err","uploadVideo","showLoading","title","chooseVideo","maxDuration","tempFilePath","thumbTempFilePath","hideLoading","showToast","duration","icon","fail","delVideo","goAddress","navigateTo","url","toast","text","isSubmit","length","isLogin","db","wx","cloud","database","user","collection","get","$nextTick","$refs","modal","init","mask","avatarUrl","_openid","uploadData","uploadImgData","imgData","uploadvideoData","videoData","uploadAllData","imgPathArr","Promise","resolve","reject","forEach","img","site","lastIndexOf","suffix","slice","imgPath","now","Math","floor","random","uploadFile","cloudPath","filePath","fileID","videoPath","userUploadData","add","datainfo","isUploaded","setTimeout","switchTab","$store","commit"],"mappings":"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","file":"pages/upload/upload.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/upload/upload.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./upload.vue?vue&type=template&id=70d6f397&scoped=true&\"\nvar renderjs\nimport script from \"./upload.vue?vue&type=script&lang=js&\"\nexport * from \"./upload.vue?vue&type=script&lang=js&\"\nimport style0 from \"./upload.vue?vue&type=style&index=0&id=70d6f397&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"70d6f397\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=template&id=70d6f397&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=script&lang=js&\"","//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n\r\nimport { preview } from '../../common/js/common.js';\r\nimport { addressData } from '../../common/network/map.js';\r\nimport { mapState } from 'vuex';\r\n// 引入时间\r\nvar util = require('../../common/js/time.js');\r\nvar time = util.formatTime(new Date());\r\n\r\nexport default {\r\n\tname: 'Upload',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcurrentIndex: 0,\r\n\t\t\tclassify: ['景点', '美食', '网红', '打卡'],\r\n\t\t\tbook: '',\r\n\t\t\tclassifyName: '', //分类名\r\n\t\t\tuploadTitle: '', //标题\r\n\t\t\tuploadContent: '', //内容\r\n\t\t\tuploadedImg: [], //上传的图片\r\n\t\t\tvideoSrc: '', //上传的视频\r\n\t\t\taddress: '', //定位\r\n\t\t\tavatar: '', //头像\r\n\t\t\tnickName: '', //昵称\r\n\t\t\topenid: '', //openid\r\n\t\t\ttime: time //当前时间\r\n\t\t};\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState(['city']),\r\n\t\tgetCity() {\r\n\t\t\tthis.address = this.city.city || '获取定位';\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t// 点击分类\r\n\t\ttapItem(index, name) {\r\n\t\t\tthis.currentIndex = index;\r\n\t\t\tthis.classifyName = name;\r\n\t\t},\r\n\t\t// 点击上传图片\r\n\t\tuploadImg() {\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tcount: 8,\r\n\t\t\t\tsizeType: ['original', 'compressed'],\r\n\t\t\t\tsourceType: ['album'],\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\tthis.uploadedImg.push(...res.tempFilePaths);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 删除图片\r\n\t\tdelImage(index) {\r\n\t\t\tthis.uploadedImg.splice(index, 1);\r\n\t\t},\r\n\t\t// 预览图片\r\n\t\tpreviewImg(index) {\r\n\t\t\tpreview(index, this.uploadedImg)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tconsole.log('预览成功');\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tconsole.log('预览失败');\r\n\t\t\t\t});\r\n\t\t},\r\n\t\t// 上传视频\r\n\t\tuploadVideo() {\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '上传中'\r\n\t\t\t});\r\n\t\t\tuni.chooseVideo({\r\n\t\t\t\tcount: 1,\r\n\t\t\t\tsourceType: ['camera', 'album'],\r\n\t\t\t\tmaxDuration: 60,\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tthis.videoSrc = res.tempFilePath;\r\n\t\t\t\t\tthis.book = res.thumbTempFilePath;\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '上传成功',\r\n\t\t\t\t\t\tduration: 1000,\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfail: err => {\r\n\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '上传失败',\r\n\t\t\t\t\t\tduration: 1000,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 删除视频\r\n\t\tdelVideo() {\r\n\t\t\tthis.videoSrc = '';\r\n\t\t},\r\n\t\t// 获取定位\r\n\t\tgoAddress() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/search/search'\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 提示弹框\r\n\t\ttoast(text) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: text,\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 发布\r\n\t\tisSubmit() {\r\n\t\t\tthis.classifyName == '' ? (this.classifyName = this.classify[0]) : '';\r\n\t\t\tconsole.log(this.classifyName);\r\n\t\t\tconsole.log(this.uploadTitle);\r\n\t\t\tconsole.log(this.uploadContent);\r\n\t\t\tconsole.log(this.uploadedImg);\r\n\t\t\tconsole.log(this.videoSrc);\r\n\t\t\tconsole.log(this.address);\r\n\t\t\tif (this.uploadTitle == '') {\r\n\t\t\t\tthis.toast('请输入标题');\r\n\t\t\t} else if (this.uploadContent == '') {\r\n\t\t\t\tthis.toast('请输入发表内容');\r\n\t\t\t} else if (this.uploadedImg.length < 3) {\r\n\t\t\t\tthis.toast('上传的图片不小于三张');\r\n\t\t\t} else {\r\n\t\t\t\tthis.isLogin();\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 判断是否登录\r\n\t\tisLogin() {\r\n\t\t\t// 请求数据库查看是否存在\r\n\t\t\tvar db = wx.cloud.database();\r\n\t\t\tvar user = db.collection('user');\r\n\t\t\tuser.get()\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\tif (res.data.length == 0) {\r\n\t\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\t\tthis.$refs.modal.init();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\ttitle: '正在上传',\r\n\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.avatar = res.data[0].avatarUrl;\r\n\t\t\t\t\t\tthis.nickName = res.data[0].nickName;\r\n\t\t\t\t\t\tthis.openid = res.data[0]._openid;\r\n\t\t\t\t\t\t// 上传数据到服务器\r\n\t\t\t\t\t\tthis.uploadData();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tthis.toast('登录失败');\r\n\t\t\t\t});\r\n\t\t},\r\n\t\t// 上传数据到数据库\r\n\t\tasync uploadData() {\r\n\t\t\t// 1.上传图片，2.上传视频，3.上传所有数据\r\n\t\t\t// 1.上传图片\r\n\t\t\tlet imgData = await this.uploadImgData();\r\n\t\t\tconsole.log(imgData);\r\n\t\t\t// 2.上传视频\r\n\t\t\tlet videoData = await this.uploadvideoData();\r\n\t\t\tconsole.log(videoData);\r\n\t\t\t// 3.上传所有数据\r\n\t\t\tawait this.uploadAllData(imgData, videoData);\r\n\t\t},\r\n\t\t// 1.上传图片\r\n\t\tuploadImgData() {\r\n\t\t\t//把上传成功的图片路径放在数组里\r\n\t\t\tlet imgPathArr = [];\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t// 取出图片数组每一项\r\n\t\t\t\tthis.uploadedImg.forEach(img => {\r\n\t\t\t\t\t// 截取后缀\r\n\t\t\t\t\tlet site = img.lastIndexOf('.');\r\n\t\t\t\t\tlet suffix = img.slice(site);\r\n\t\t\t\t\t// 时间戳+随机数\r\n\t\t\t\t\tlet imgPath = Date.now() + '-' + Math.floor(Math.random(0, 1) * 1000000) + suffix;\r\n\t\t\t\t\twx.cloud\r\n\t\t\t\t\t\t.uploadFile({\r\n\t\t\t\t\t\t\tcloudPath: 'static/' + imgPath,\r\n\t\t\t\t\t\t\tfilePath: img\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\timgPathArr.push(res.fileID);\r\n\t\t\t\t\t\t\t// 判断上传的图片长度和暂存的数组是否一样长（上传的完整性）\r\n\t\t\t\t\t\t\tif (imgPathArr.length == this.uploadedImg.length) {\r\n\t\t\t\t\t\t\t\tresolve(imgPathArr);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 2.上传视频\r\n\t\tuploadvideoData() {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t// 判断用户是否要上传视频\r\n\t\t\t\tif (this.videoSrc == '') {\r\n\t\t\t\t\tresolve('');\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 截取后缀\r\n\t\t\t\t\tlet site = this.videoSrc.lastIndexOf('.');\r\n\t\t\t\t\tlet suffix = this.videoSrc.slice(site);\r\n\t\t\t\t\t// 时间戳+随机数\r\n\t\t\t\t\tlet videoPath = Date.now() + '-' + Math.floor(Math.random(0, 1) * 1000000) + suffix;\r\n\t\t\t\t\twx.cloud\r\n\t\t\t\t\t\t.uploadFile({\r\n\t\t\t\t\t\t\tcloudPath: 'videostatic/' + videoPath,\r\n\t\t\t\t\t\t\tfilePath: this.videoSrc\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tresolve(res.fileID);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 3.上传所有数据\r\n\t\tuploadAllData(imgData, videoData) {\r\n\t\t\tlet userUploadData = {\r\n\t\t\t\tclassifyName: this.classifyName, //分类名\r\n\t\t\t\tuploadTitle: this.uploadTitle, //标题\r\n\t\t\t\tuploadContent: this.uploadContent, //内容\r\n\t\t\t\tuploadedImg: imgData, //上传的图片\r\n\t\t\t\tvideoSrc: videoData, //上传的视频\r\n\t\t\t\taddress: this.address, //定位\r\n\t\t\t\tavatar: this.avatar, //头像\r\n\t\t\t\tnickName: this.nickName, //昵称\r\n\t\t\t\topenid: this.openid, //openid\r\n\t\t\t\ttime: this.time //时间\r\n\t\t\t};\r\n\t\t\tconsole.log(userUploadData);\r\n\t\t\tvar db = wx.cloud.database();\r\n\t\t\tdb.collection('usersUploadData')\r\n\t\t\t\t.add({\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tdatainfo: userUploadData\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t// 上传成功\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tthis.toast('上传成功!');\r\n\t\t\t\t\t// vuex传值给攻略页面，提示刷新数据\r\n\t\t\t\t\tlet isUploaded = true;\r\n\t\t\t\t\t// 跳转\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\turl: '../strategy/strategy'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.$store.commit('changeUploadedStatus', isUploaded);\r\n\t\t\t\t\t}, 1700);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=style&index=0&id=70d6f397&scoped=true&lang=css&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=style&index=0&id=70d6f397&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1592316841246\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}
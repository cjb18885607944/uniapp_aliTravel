{"version":3,"sources":["webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/main.js","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?39ed","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?26cf","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?74df","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?9b24","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?c979","webpack:///C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue?1e4b"],"names":["createPage","Page","util","require","time","formatTime","Date","name","data","currentIndex","classify","book","classifyName","uploadTitle","uploadContent","uploadedImg","videoSrc","address","avatar","nickName","openid","computed","getCity","city","methods","tapItem","index","uploadImg","uni","chooseImage","count","sizeType","sourceType","success","res","console","log","push","tempFilePaths","delImage","splice","previewImg","then","catch","err","uploadVideo","showLoading","title","chooseVideo","maxDuration","tempFilePath","thumbTempFilePath","hideLoading","showToast","duration","icon","fail","delVideo","goAddress","navigateTo","url","toast","text","isSubmit","length","isLogin","db","wx","cloud","database","user","collection","get","$nextTick","$refs","modal","init","mask","avatarUrl","_openid","uploadData","uploadImgData","imgData","uploadvideoData","videoData","uploadAllData","imgPathArr","Promise","resolve","reject","forEach","img","site","lastIndexOf","suffix","slice","imgPath","now","Math","floor","random","uploadFile","cloudPath","filePath","fileID","videoPath","userUploadData","add","datainfo","setTimeout","switchTab"],"mappings":"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","file":"pages/upload/upload.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/upload/upload.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./upload.vue?vue&type=template&id=70d6f397&scoped=true&\"\nvar renderjs\nimport script from \"./upload.vue?vue&type=script&lang=js&\"\nexport * from \"./upload.vue?vue&type=script&lang=js&\"\nimport style0 from \"./upload.vue?vue&type=style&index=0&id=70d6f397&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"70d6f397\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"C:/Users/Administrator/Desktop/uniapp/uniapp_aliTravel/pages/upload/upload.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=template&id=70d6f397&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {preview} from '../../common/js/common.js'\nimport {addressData} from '../../common/network/map.js'\nimport {mapState} from 'vuex'\n// 引入时间\nvar util = require('../../common/js/time.js')\nvar time = util.formatTime(new Date())\n\nexport default{\n\tname:'Upload',\n\tdata(){\n\t\treturn{\n\t\t\tcurrentIndex:0,\n\t\t\tclassify:['景点','美食','网红','打卡'],\n\t\t\tbook:'',\n\t\t\tclassifyName:'',//分类名\n\t\t\tuploadTitle:'',//标题\n\t\t\tuploadContent:'',//内容\n\t\t\tuploadedImg:[],//上传的图片\n\t\t\tvideoSrc:'',//上传的视频\n\t\t\taddress:'',//定位\n\t\t\tavatar:'',//头像\n\t\t\tnickName:'',//昵称\n\t\t\topenid:'',//openid\n\t\t\ttime:time//当前时间\n\t\t}\n\t},\n\tcomputed:{\n\t\t...mapState(['city']),\n\t\tgetCity(){\n\t\t\tthis.address = this.city.city || '获取定位'\n\t\t}\n\t},\n\tmethods:{\n\t\t// 点击分类\n\t\ttapItem(index,name){\n\t\t\tthis.currentIndex = index\n\t\t\tthis.classifyName = name\n\t\t},\n\t\t// 点击上传图片\n\t\tuploadImg(){\n\t\t\tuni.chooseImage({\n\t\t\t\tcount:8,\n\t\t\t\tsizeType:['original','compressed'],\n\t\t\t\tsourceType:['album'],\n\t\t\t\tsuccess:res => {\n\t\t\t\t\tconsole.log(res)\n\t\t\t\t\tthis.uploadedImg.push(...res.tempFilePaths)\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t// 删除图片\n\t\tdelImage(index){\n\t\t\tthis.uploadedImg.splice(index,1)\n\t\t},\n\t\t// 预览图片\n\t\tpreviewImg(index){\n\t\t\tpreview(index,this.uploadedImg)\n\t\t\t.then(res => {\n\t\t\t\tconsole.log('预览成功')\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.log('预览失败')\n\t\t\t})\n\t\t},\n\t\t// 上传视频\n\t\tuploadVideo(){\n\t\t\tuni.showLoading({\n\t\t\t\ttitle:'上传中'\n\t\t\t})\n\t\t\tuni.chooseVideo({\n\t\t\t\tcount:1,\n\t\t\t\tsourceType:['camera','album'],\n\t\t\t\tmaxDuration:60,\n\t\t\t\tsuccess:res => {\n\t\t\t\t\tthis.videoSrc = res.tempFilePath\n\t\t\t\t\tthis.book = res.thumbTempFilePath\n\t\t\t\t\tconsole.log(res)\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle:'上传成功',\n\t\t\t\t\t\tduration:1000,\n\t\t\t\t\t\ticon:'success'\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tfail: err =>{\n\t\t\t\t\tconsole.log(err)\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle:'上传失败',\n\t\t\t\t\t\tduration:1000,\n\t\t\t\t\t\ticon:'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t// 删除视频\n\t\tdelVideo(){\n\t\t\tthis.videoSrc = ''\n\t\t},\n\t\t// 获取定位\n\t\tgoAddress(){\n\t\t\tuni.navigateTo({\n\t\t\t\turl:'/pages/search/search'\n\t\t\t})\n\t\t},\n\t\t// 提示弹框\n\t\ttoast(text){\n\t\t\tuni.showToast({\n\t\t\t\ttitle:text,\n\t\t\t\ticon:'none'\n\t\t\t})\n\t\t},\n\t\t// 发布\n\t\tisSubmit(){\n\t\t\tthis.classifyName == '' ? this.classifyName = this.classify[0] : ''\n\t\t\tconsole.log(this.classifyName)\n\t\t\tconsole.log(this.uploadTitle)\n\t\t\tconsole.log(this.uploadContent)\n\t\t\tconsole.log(this.uploadedImg)\n\t\t\tconsole.log(this.videoSrc)\n\t\t\tconsole.log(this.address)\n\t\t\tif(this.uploadTitle == ''){\n\t\t\t\tthis.toast('请输入标题')\n\t\t\t}else if(this.uploadContent == ''){\n\t\t\t\tthis.toast('请输入发表内容')\n\t\t\t}else if(this.uploadedImg.length < 3){\n\t\t\t\tthis.toast('上传的图片不小于三张')\n\t\t\t}else{\n\t\t\t\tthis.isLogin()\n\t\t\t}\n\t\t},\n\t\t// 判断是否登录\n\t\tisLogin(){\n\t\t\t// 请求数据库查看是否存在\n\t\t\tvar db = wx.cloud.database()\n\t\t\tvar user = db.collection('user')\n\t\t\tuser.get().then(res => {\n\t\t\t\tconsole.log(res)\n\t\t\t\tif(res.data.length == 0){\n\t\t\t\t\tthis.$nextTick(()=>{\n\t\t\t\t\t\tthis.$refs.modal.init()\n\t\t\t\t\t})\n\t\t\t\t}else{\n\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\ttitle:'正在上传',\n\t\t\t\t\t\tmask:true\n\t\t\t\t\t})\n\t\t\t\t\tthis.avatar = res.data[0].avatarUrl\n\t\t\t\t\tthis.nickName = res.data[0].nickName\n\t\t\t\t\tthis.openid = res.data[0]._openid\n\t\t\t\t\t// 上传数据到服务器\n\t\t\t\t\tthis.uploadData()\n\t\t\t\t}\n\t\t\t}).catch(err => {\n\t\t\t\tthis.toast('登录失败')\n\t\t\t})\n\t\t},\n\t\t// 上传数据到数据库\n\t\tasync uploadData(){\n\t\t\t// 1.上传图片，2.上传视频，3.上传所有数据\n\t\t\t// 1.上传图片\n\t\t\tlet imgData = await this.uploadImgData()\n\t\t\tconsole.log(imgData)\n\t\t\t// 2.上传视频\n\t\t\tlet videoData = await this.uploadvideoData()\n\t\t\tconsole.log(videoData)\n\t\t\t// 3.上传所有数据\n\t\t\tawait this.uploadAllData(imgData,videoData)\n\t\t\t\n\t\t},\n\t\t// 1.上传图片\n\t\tuploadImgData(){\n\t\t\t//把上传成功的图片路径放在数组里\n\t\t\tlet imgPathArr = []\n\t\t\treturn new Promise((resolve,reject) => {\n\t\t\t\t// 取出图片数组每一项\n\t\t\t\tthis.uploadedImg.forEach((img) => {\n\t\t\t\t\t// 截取后缀\n\t\t\t\t\tlet site = img.lastIndexOf('.')\n\t\t\t\t\tlet suffix = img.slice(site)\n\t\t\t\t\t// 时间戳+随机数\n\t\t\t\t\tlet imgPath =Date.now() + '-' + Math.floor(Math.random(0,1) * 1000000) + suffix\n\t\t\t\t\twx.cloud.uploadFile({\n\t\t\t\t\t\tcloudPath:'static/'+imgPath,\n\t\t\t\t\t\tfilePath:img\n\t\t\t\t\t}).then(res => {\n\t\t\t\t\t\timgPathArr.push(res.fileID)\n\t\t\t\t\t\t// 判断上传的图片长度和暂存的数组是否一样长（上传的完整性）\n\t\t\t\t\t\tif(imgPathArr.length == this.uploadedImg.length){\n\t\t\t\t\t\t\tresolve(imgPathArr)\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(err => {\n\t\t\t\t\t\tconsole.log(err)\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t})\n\t\t},\n\t\t// 2.上传视频\n\t\tuploadvideoData(){\n\t\t\treturn new Promise((resolve,reject) => {\n\t\t\t\t// 判断用户是否要上传视频\n\t\t\t\tif(this.videoSrc == ''){\n\t\t\t\t\tresolve('')\n\t\t\t\t}else{\n\t\t\t\t\t// 截取后缀\n\t\t\t\t\tlet site = this.videoSrc.lastIndexOf('.')\n\t\t\t\t\tlet suffix = this.videoSrc.slice(site)\n\t\t\t\t\t// 时间戳+随机数\n\t\t\t\t\tlet videoPath =Date.now() + '-' + Math.floor(Math.random(0,1) * 1000000) + suffix\n\t\t\t\t\twx.cloud.uploadFile({\n\t\t\t\t\t\tcloudPath:'videostatic/'+videoPath,\n\t\t\t\t\t\tfilePath:this.videoSrc\n\t\t\t\t\t}).then(res => {\n\t\t\t\t\t\tresolve(res.fileID)\n\t\t\t\t\t}).catch(err => {\n\t\t\t\t\t\tconsole.log(err)\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t// 3.上传所有数据\n\t\tuploadAllData(imgData,videoData){\n\t\t\tlet userUploadData = {\n\t\t\t\tclassifyName:this.classifyName,//分类名\n\t\t\t\tuploadTitle:this.uploadTitle,//标题\n\t\t\t\tuploadContent:this.uploadContent,//内容\n\t\t\t\tuploadedImg:imgData,//上传的图片\n\t\t\t\tvideoSrc:videoData,//上传的视频\n\t\t\t\taddress:this.address,//定位\n\t\t\t\tavatar:this.avatar,//头像\n\t\t\t\tnickName:this.nickName,//昵称\n\t\t\t\topenid:this.openid,//openid\n\t\t\t\ttime:this.time//时间\n\t\t\t}\n\t\t\tconsole.log(userUploadData)\n\t\t\tvar db = wx.cloud.database()\n\t\t\tdb.collection('usersUploadData').add({\n\t\t\t\tdata:{\n\t\t\t\t\tdatainfo:userUploadData\n\t\t\t\t}\n\t\t\t}).then(res => {\n\t\t\t\tconsole.log(res)\n\t\t\t\t// 上传成功\n\t\t\t\tuni.hideLoading()\n\t\t\t\tthis.toast('上传成功!')\n\t\t\t\t// 跳转\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tuni.switchTab({\n\t\t\t\t\t\turl:'../strategy/strategy'\n\t\t\t\t\t})\n\t\t\t\t},1500)\n\t\t\t}).catch(err => {\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t\t}\n\t}\n}\n","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=style&index=0&id=70d6f397&scoped=true&lang=css&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./upload.vue?vue&type=style&index=0&id=70d6f397&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1590070335618\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}